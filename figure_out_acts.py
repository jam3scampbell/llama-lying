#%%

import os
import re

def extract_info(filename):
    match = re.match(r"run_3000_(.+)_(-?\d+)_z_(\d+)", filename)
    if match:
        return match.group(1), int(match.group(2)), int(match.group(3))
    return None, None, None

def main():
    directory = "data/large_run_3000/activations/unformatted"
    names = [f"sys_other_{i}" for i in range(1, 12)]

    datapoints = {name: set() for name in names}

    for filename in os.listdir(directory):
        name, seqpos, datapoint = extract_info(filename)
        if name in names and -20 <= seqpos <= -1:
            datapoints[name].add(datapoint)

    for name in names:
        print(f"{name} ({len(datapoints[name])}): {sorted(datapoints[name])}")

    name1 = "sys_other_11" #"sys_other_1" 
    name2 = "sys_other_4"

    missing_datapoints1 = datapoints[name2] - datapoints[name1]
    missing_datapoints2 = datapoints[name1] - datapoints[name2]

    print(f"Additional datapoints needed for {name1}: {sorted(missing_datapoints1)}")
    print(f"Additional datapoints needed for {name2}: {sorted(missing_datapoints2)}")

if __name__ == "__main__":
    main()
# %%

# run both honesty, lying (no prefix) on [27, 39, 40, 51, 110, 130, 155, 237, 266, 277, 282, 289, 297, 328, 329, 383, 477, 491, 549, 554, 567, 734, 754, 769, 788, 793, 822, 979, 1054, 1102, 1148, 1178, 1200, 1239, 1271, 1329, 1345, 1355, 1448, 1487, 1641, 1642, 1645, 1764, 1904, 1972, 1987, 2080, 2113, 2117, 2118, 2241, 2288, 2364, 2478, 2492, 2559, 2581, 2588, 2589, 2615, 2695, 2708, 2798, 2837, 2866, 2875, 2879, 3003, 3015, 3094, 3186, 3242, 3270, 3309, 3341, 3406, 3421, 3592, 3598, 3730, 3775, 3840, 3858, 3860, 3898, 3928, 4007, 4011, 4035, 4061, 4093, 4099, 4159, 4233, 4253, 4257, 4283, 4295, 4298, 4422, 4461, 4488, 4591, 4592, 4601, 4618, 4641, 4653, 4757, 4843, 4851, 4948, 4954, 8002, 8017, 8113, 8116, 8137, 8139, 8143, 8262, 8288, 8476, 8526, 8531, 8587, 8612, 8613, 8622, 8651, 8717, 8738, 8739, 8753, 8773, 8813, 8867, 8904, 8979, 8982, 8991, 9004, 9012, 9017, 9066, 9069, 9085, 9144, 9150, 9173, 9207, 9332, 9350, 9359, 9398, 9477, 9490, 9543, 9589, 9670, 9750, 9755, 9819, 9840, 9953, 11271, 11289, 11352, 11388, 11396, 11421, 11445, 11463, 11484, 11582, 11640, 11673, 11689, 11704, 11718, 11758, 11868, 11914, 11963, 11967, 12018, 12091, 12134, 12145, 12153, 12187, 12188, 12203, 12293, 12303, 12305, 12391, 12438, 12470, 12487, 12593, 12603, 12624, 12627, 12661, 12695, 12696, 12713, 12733, 12746, 12760, 12778, 12889, 13081, 13107, 13136, 13137, 13146, 13158, 13173, 13197, 13334, 13440, 13525, 13567, 13579, 13623, 13741, 13780, 13835, 13854, 13887, 13921, 14010, 14103, 14121, 14207, 14231, 14283, 14286, 14325, 14334, 14454, 14493, 14501, 14600, 14719, 14767, 14776, 14825, 14955, 14998, 15068, 15096, 15137, 15200, 15208, 15226, 15246, 15276, 15285, 15303, 15310, 15325, 15393, 15455, 15464, 15481, 15515, 15538, 15580, 15608, 15635, 15644, 15704, 15829, 15965, 15972, 15974, 15977]

#281 * 2

# run both honesty, lying (prefix) on [27, 39, 40, 51, 110, 130, 155, 237, 266, 277, 282, 289, 297, 328, 329, 383, 477, 491, 549, 554, 567, 734, 754, 769, 788, 793, 822, 979, 1054, 1102, 1148, 1178, 1200, 1239, 1271, 1329, 1345, 1355, 1448, 1487, 1641, 1642, 1645, 1764, 1904, 1972, 1987, 2080, 2113, 2117, 2118, 2241, 2288, 2364, 2478, 2492, 2559, 2581, 2588, 2589, 2615, 2695, 2708, 2798, 2837, 2866, 2875, 2879, 3003, 3015, 3094, 3186, 3242, 3270, 3309, 3341, 3406, 3421, 3592, 3598, 3730, 3775, 3840, 3858, 3860, 3898, 3928, 4007, 4011, 4035, 4061, 4093, 4099, 4159, 4233, 4253, 4257, 4283, 4295, 4298, 4422, 4461, 4488, 4591, 4592, 4601, 4618, 4641, 4653, 4757, 4843, 4851, 4948, 4954, 5062, 7026, 7031, 7032, 7150, 7286, 7295, 7405, 7419, 7447, 7460, 7510, 7540, 7564, 7573, 7605, 7638, 7648, 7824, 7864, 7901, 7914, 7951, 7988, 8002, 8017, 8113, 8116, 8137, 8139, 8143, 8262, 8288, 8476, 8526, 8531, 8587, 8612, 8613, 8622, 8651, 8717, 8738, 8739, 8753, 8773, 8813, 8867, 8904, 8979, 8982, 8991, 9004, 9012, 9017, 9066, 9069, 9085, 9144, 9150, 9173, 9207, 9332, 9350, 9359, 9398, 9477, 9490, 9543, 9589, 9670, 9750, 9755, 9819, 9840, 9953, 11271, 11289, 11352, 11388, 11396, 11421, 11445, 11463, 11484, 11582, 11640, 11673, 11689, 11704, 11718, 11758, 11868]

#207*2

# run sys_other_1 on [51, 1642, 2288, 3898, 4592, 4851, 8113, 8139, 8904, 10654, 10661, 12487, 12603, 13081, 13567, 14103, 14283, 15635]
    
#18
 
# run sys_other_11 on [27, 39, 40, 51, 110, 130, 237, 266, 277, 282, 289, 297, 328, 383, 491, 549, 554, 567, 734, 754, 769, 788, 793, 979, 1054, 1102, 1148, 1178, 1200, 1271, 1329, 1345, 1355, 1448, 1487, 1641, 1642, 1645, 1764, 1904, 1972, 1987, 2080, 2113, 2117, 2118, 2288, 2364, 2492, 2559, 2581, 2588, 2589, 2615, 2695, 2837, 2875, 3003, 3015, 3094, 3186, 3242, 3309, 3341, 3406, 3421, 3592, 3598, 3730, 3775, 3840, 3858, 3860, 3898, 3928, 4007, 4011, 4035, 4061, 4093, 4099, 4159, 4233, 4253, 4257, 4283, 4295, 4422, 4461, 4488, 4591, 4592, 4601, 4618, 4641, 4653, 4757, 4843, 4851, 4948, 4954, 8002, 8017, 8113, 8137, 8139, 8143, 8262, 8288, 8476, 8526, 8531, 8587, 8612, 8613, 8622, 8651, 8717, 8738, 8739, 8753, 8773, 8813, 8867, 8904, 8979, 8982, 8991, 9004, 9017, 9066, 9069, 9085, 9144, 9173, 9207, 9332, 9350, 9359, 9398, 9477, 9490, 9543, 9589, 9670, 9750, 9755, 9819, 9840, 9953, 11271, 11289, 11352, 11388, 11396, 11421, 11445, 11463, 11484, 11582, 11689, 11718, 11758, 11868, 11914, 11963, 11967, 12018, 12091, 12134, 12145, 12153, 12187, 12188, 12293, 12303, 12305, 12391, 12438, 12470, 12487, 12593, 12603, 12624, 12627, 12661, 12695, 12696, 12713, 12733, 12746, 12760, 12778, 12889, 13081, 13107, 13136, 13137, 13146, 13158, 13173, 13197, 13334, 13440, 13567, 13579, 13623, 13741, 13780, 13835, 13854, 13887, 14010, 14103, 14231, 14283, 14286, 14325, 14454, 14493, 14501, 14719, 14767, 14776, 14955, 14998, 15068, 15096, 15137, 15200, 15208, 15226, 15246, 15276, 15303, 15310, 15325, 15393, 15455, 15464, 15515, 15538, 15580, 15608, 15635, 15644, 15704, 15829, 15965, 15974]

#250